ORG	00H
	MOV	A,#00H
	MOV	B,#00H
	AJMP	MAIN

MAIN:	MOV	A,#0F0H
	MOV	P0,A
	MOV	B,#0FFH
	MOV	P1,B
	MOV	P2,B
	MOV	DPTR,#SEG

TOPTL:ACALL	SET
	MOV	A,#0F0H
	MOV	P0,A
	ACALL	DELAYRED
	MOV	P0,#01H
	MOV	A,#0EH
	MOV	P1,A
	ACALL	DELAYGREEN
	MOV	A,#0FH
	MOV	P1,A
	MOV	A,#0EH
	MOV	P2,A
	ACALL	DELAYYELLOW
	MOV	A,#0FH
	MOV	P2,A

RIGHTTL:ACALL	SET
	MOV	A,#0F0H
	MOV	P0,A
	ACALL	DELAYRED
	MOV	P0,#02H
	MOV	A,#0DH
	MOV	P1,A
	ACALL	DELAYGREEN
	MOV	A,#0FH
	MOV	P1,A
	MOV	A,#0DH
	MOV	P2,A
	ACALL	DELAYYELLOW
	MOV	A,#0FH
	MOV	P2,A

BOTTOMTL:ACALL	SET
	MOV	A,#0F0H
	MOV	P0,A
	ACALL	DELAYRED
	MOV	P0,#04H
	MOV	A,#0BH
	MOV	P1,A
	ACALL	DELAYGREEN
	MOV	A,#0FH
	MOV	P1,A
	MOV	A,#0BH
	MOV	P2,A
	ACALL	DELAYYELLOW
	MOV	A,#0FH
	MOV	P2,A

LEFTTL:ACALL	SET
	MOV	A,#0F0H
	MOV	P0,A
	ACALL	DELAYRED
	MOV	P0,#08H
	MOV	A,#07H
	MOV	P1,A
	ACALL	DELAYGREEN
	MOV	A,#0FH
	MOV	P1,A
	MOV	A,#07H
	MOV	P2,A
	ACALL	DELAYYELLOW
	MOV	A,#0FH
	MOV	P2,A
	ACALL	MAIN

DELAYGREEN:MOV	A,R1	;read input value
	ANL	A,#0FH	;mask out upper nibbles
	MOVC	A,@A+DPTR
	MOV	P3,A
	DEC	R1
	DJNZ	R3,DELAYGREEN
	MOV	R1,#08H
	RET

DELAYYELLOW:MOV	A,R2	;read input value
	ANL	A,#0FH	;mask out upper nibbles
	MOVC	A,@A+DPTR
	MOV	P3,A
	DEC	R2
	DJNZ	R4,DELAYYELLOW	;decrement in R2 and loop until value reach 0
MOV	R2,#02H
	RET

DELAYRED: MOV	A,R4
	ANL	A,#0FH
	MOVC	A,@A+DPTR
	MOV	P3,A
	DEC	R4
	DJNZ	R5,DELAYRED
MOV	R4,#04H
	RET

SET:	MOV	R1,#08H
	MOV	R3,#09H
	MOV	R2,#02H
	MOV	R4,#04H
	MOV	R5,#05H
	RET

SEG:	DB	3FH,06H,5BH,4FH,66H,6DH,7DH,07H,7FH,6FH,77H,7CH,39H,5EH,79H,71H
	END
